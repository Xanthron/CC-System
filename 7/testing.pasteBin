# -*- coding: utf-8 -*-
"""
Created on Sun Jan 12 15:09:17 2020

@author: Student
"""

import pandas as pd
import numpy as np


dane = pd.read_csv('wine.data', sep=',', header=None)
type(dane)

X = dane.iloc[:,0:4]
Y = dane.iloc[:,4]
type(X)
X = X.values
X.shape
Y = Y.values

import tensorflow as tf
dir(tf)

from tensorflow.keras.models import Sequential

model = Sequential()

from tensorflow.keras.layers import Dense
model.add(Dense(10, activation='relu', input_dim=4))
model.add(Dense(8, activation='relu'))
model.add(Dense(3, activation='softmax'))
model.compile(loss='mean_squared_error', optimizer='Adam')
model.summary()

from tensorflow.keras.utils import to_categorical

Yn = to_categorical(Y)
Yn = Yn[:,1:4]
his = model.fit(X, Yn, epochs=10)
his.history['loss']

import matplotlib.pyplot as plt

os_y = his.history['loss']
os_x = np.arange(len(os_y))
plt.plot(os_x, os_y)